# java面试第一季

## 1.javase  变量自增

## 13.linux常用服务类命令

```
# service network status //查看网络状态
# service network stop //停止
# service network restart //重启
# service network reload  //重新加载
# service network start //启动
通过chkconfig命令设置自启动
# 查看服务 chkconfig --list | grep xxx
# chkconfig --level 5 服务名  on  
```

## 14.git相关命令

```
创建分支
·git branch<分支名>
·git branch-v查看分支
>切换分支
·git checkout<分支名>
·一步完成：git checkout-b<分支名>
>合并分支
·先切换到主干git checkout master
·git merge<分支名>
删除分支
·先切换到主干 git checkout master
·git branch-D<分支名>
```

![](e://pic/搜狗截图20200321152612.png)

## 15.redis的持久化

Redis提供了2个不同形式的持久化方式

### RDB(redis Database)

​	RDB在指定的时间间隔内将内存中的数据集快照写入磁盘，也就是行话讲的Snapshot快照，它恢复时是将快照文件直接读到内存里。

#### 备份是如何执行的

​	Redis会单独创建（fork）一个子进程来进行持久化，会先将数据写入到一个临时文件中，待持久化过程都结束了，再用这个临时文件替换上次持久化好的文件。整个过程中，主进程是不进行任何IO操作的，这就确保了极高的性能如果需要进行规模数据的恢复，且对于数据恢复的完整性不是非常敏感，那RDB方式要比AOF方式更加的高效。
RDB的缺点是最后一次持久化后的数据可能丢失。

rdb的备份
​	·先通过config get dir查询rdb文件的目录
​	·将*.rdb的文件拷贝到别的地方

rdb的恢复
​	关闭Redis先把备份的文件拷贝到工作目录下启动Redis，备份数据会直接加载

![](e:/pic/搜狗截图20200321153120.png)



### AOF(Append Of file)

​	以**日志的形式**来记录每个写操作，将Redis执行过的所有写指令记录下来（读操作不记录），只许追加文件但不可以改写文件，Redis启动之初会读取该文件重新构建数据，换言之，Redis重启的话就根据日志文件的内容将写指令从前到后执行一次以完成数据的恢复工作。

![](e://pic/搜狗截图20200321153323.png)

## 16.Mysql索引

​	MySQL官方对索引的定义为：索引（Index）是帮助MySQL高效获取数据的数据结构。
可以得到索引的本质：索引是数据结构。

### 优势

1.类似大学图书馆建书目索引，提高数据检索的效率，降低数据库的IO成本优势s
2.通过索引列对数据进行排序，降低数据排序的成本，降低了CPU的消耗

### 劣势

虽然索引大大提高了查询速度，同时却会降低更新表的速度，如对表进行INSERT、UPDATE和DELETE。
因为更新表时，MySQL不仅要保存数据，还要保存一下索引文件每次更新添加了索引列的字段，都会调整因为更新所带来的键值变化后的索引信息
一实际上索引也是一张表，该表保存了主键与索引字段，并指向实体表的记录，所以索引列也是要占用空间的

### 那种情况下需要创建索引

- 主键自动建立唯一索引
- 频繁作为查询条件的字段应该创建索引
- 查询中与其他表关联的字段，外键关系建立索引。
- 单键/组合索引的选择问题，组合索引性价比更高
- 查询中排序的字段，排序字段若通过索引访问将大大提高排序速度。
- 查询中统计或分组字段

### 那种情况下不要创建索引

- 表记录太少
- 经常修改的表或字段
- where 条件用不到的字段
- 过滤性不好的不适合建索引

## 17.java垃圾回收机制

java垃圾回收算法在哪个部分 堆中

1.引用计数法(循环引用问题)

2.复制算法 年轻代

3.标记清除

4.标记压缩

## 18.redis的使用场景

| 数据类型   | 使用场景                                     |
| ------ | ---------------------------------------- |
| String | 比如说 ，我想知道什么时候封锁一个IP地址。Incrby命令           |
| Hash   | 存储用户信息【id，name，age】Hset(key,field,value)Hset(userKey,id,101)Hset(userKey,name,admin)Hset(userKey,age,23)----修改案例----Hget(userKey,id)Hset(userKey,id,102)为什么不使用String 类型来存储Set(userKey,用信息的字符串)Get(userKey)不建议使用String 类型 |
| List   | 实现最新消息的排行，还可以利用List的push命令，将任务存在list集合中，同时使用另一个命令，将任务从集合中取出[pop]。Redis—list数据类型来模拟**消息队列**。【电商中的秒杀就可以采用这种方式来完成一个秒杀活动】 |
| Set    | 特殊之处：可以自动排重。比如说微博中将每个人的好友存在集合(Set)中，这样求两个人的共通好友的操作。我们只需要求交集即可。 |
| Zset   | 以某一个条件为权重，进行排序。京东：商品详情的时候，都会有一个综合排名，还可以按照价格进行排名。 |



## 19.单点登录

![](e://pic/图片1.png)

单点登录：一处登录多处使用！

前提：单点登录**多使用在分布式系统**中。



Demo：

参观动物园流程：

检票员=认证中心模块

1. 我直接带着大家进动物园，则会被检票员拦住【看我们是否有门票】，没有[售票处买票]

登录=买票

2. 我去买票【带着票，带着大家一起准备进入动物园】检票员check【有票】

Token=piao

3. 我们手中有票就可以任意观赏动物的每处景点。

京东：单点登录，是将token放入到cookie中的。

​	案例：将浏览器的cookie禁用，则在登录京东则失败！无论如何登录不了！

## 20.购物车实现过程

购物车：

1. 购物车跟用户的关系?

a) 一个用户必须对应一个购物车【一个用户不管买多少商品，都会存在属于自己的购物车中。】

b) 单点登录一定在购物车之前。

2. 跟购物车有关的操作有哪些?

​	a) 添加购物车

​		i. 用户未登录状态

​			1. 添加到什么地方?未登录将数据保存到什么地方?

​				a) Redis? --- 京东

​				b) **Cookie**? --- 自己开发项目的时候【如果浏览器禁用cookie】

​		ii. 用户登录状态

​			1. Redis 缓存中 【读写速度快】

​			a) Hash ：hset(key,field,value)

​			i. Key:user:userId:cart

​			ii. Hset(key,skuId,value);

​		2. 存在数据库中【oracle，mysql】

​	b) 展示购物车

​		i. 未登录状态展示

​		1. 直接从cookie 中取得数据展示即可

ii. 登录状态

1. 用户一旦登录：必须显示数据库【redis】+cookie 中的购物车的数据

a) Cookie 中有三条记录

b) Redis中有五条记录

c) 真正展示的时候应该是八条记录

## 21.消息队列在项目中的使用

背景：在分布式系统中是如何处理高并发的。
​	由于在高并发的环境下，来不及同步处理用户发送的请求，则会导致请求发生阻塞。比如说，大量的insert，update之类的请求同时到达数据库MYSQL，直接导致无数的行锁表锁，甚至会导致请求堆积很多。从而触发 too many connections 错误。使用消息队列可以解决【异步通信】

### 1.异步

![](e:/pic/图片2.png)

### 2.并行

![](e://pic/图片3.png)

### 3.排队

![](e://pic/图片4.png)

###  消息队列电商使用场景

![](e://pic/图片5.png)







